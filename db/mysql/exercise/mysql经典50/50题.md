# [Mysql ç»å…¸ 50 é¢˜](https://juejin.cn/post/6844903823819931662)

- 1ã€å­¦ç”Ÿè¡¨

```sql
CREATE TABLE student (
	sid varchar(10),   # å­¦ç”Ÿid
	sname varchar(10), # å§“å
	sage datetime,     # å¹´é¾„
	ssex varchar(10)   # æ€§åˆ«
);
```

- 2ã€è¯¾ç¨‹è¡¨

```sql
CREATE TABLE course (
	cid varchar(10),   # è¯¾ç¨‹id
	cname varchar(10), # è¯¾ç¨‹åç§°
	tid varchar(10)    # è€å¸ˆid
);
```

- 3ã€æ•™å¸ˆè¡¨

```sql
CREATE TABLE teacher (
	tid varchar(10),  # æ•™å¸ˆid
	tname varchar(10) # æ•™å¸ˆåç§°
);
```

- 4ã€æˆç»©è¡¨

```sql
CREATE TABLE sc (
	sid varchar(10),       # å­¦ç”Ÿid
	cid varchar(10),       # è¯¾ç¨‹id
	score decimal(18, 1)   # å¾—åˆ†
);
```

## é¢˜ç›®

1. æŸ¥è¯¢é€‰ä¿®äº†"01"ï¼Œ"02"çš„å­¦ç”Ÿçš„ä¿¡æ¯åŠè¯¾ç¨‹åˆ†æ•°ï¼Œè¦æ±‚ "01" çš„åˆ†æ•°æ¯” "02" è¯¾ç¨‹é«˜

```sql
select s.*,c1.score,c2.score
from student s, sc c1,sc c2
where s.sid = c1.sid
and c1.sid = c2.sid
and c1.cid = "01"
and c2.cid = "02"
and c1.score > c2.score;
```

2. æŸ¥è¯¢é€‰ä¿®äº† "01"ï¼Œ"02" çš„å­¦ç”Ÿçš„ä¿¡æ¯åŠè¯¾ç¨‹åˆ†æ•°ï¼Œè¦æ±‚ "01" æ¯” "02" è¯¾ç¨‹æˆç»©ä½

```sql
-- ä¸‰è¡¨è¿æ¥æŸ¥è¯¢
select s.*,c1.score,c2.score
from student s
join sc c1 on s.sid = c1.sid and c1.cid = "01"
join sc c2 on s.sid = c2.sid and c2.cid = "02"
where c1.score < c2.score;
```

3. æŸ¥è¯¢å¹³å‡æˆç»©å¤§äºç­‰äº 60 åˆ†çš„å­¦ç”Ÿçš„å­¦ç”Ÿ id å’Œå­¦ç”Ÿå§“åå’Œå¹³å‡æˆç»©(æ­¤å¤„æ°å¥½æ˜¯å­¦ç”Ÿå”¯ä¸€æ‰€ä»¥å¯ä»¥ä½¿ç”¨å­¦ç”Ÿ id)

```sql
select s.sid,avg(c1.score)
from student s
join sc c1 on s.sid=c1.sid
group by sname
having avg(score)>=60;
```

4. æŸ¥è¯¢å¹³å‡æˆç»©å°äº 60 åˆ†çš„åŒå­¦çš„å­¦ç”Ÿç¼–å·å’Œå­¦ç”Ÿå§“åå’Œå¹³å‡æˆç»©

```sql
select s.sid,avg(c1.score)
from student s
join sc c1 on s.sid=c1.sid
group by sname
having avg(score)<60;
```

5. æŸ¥è¯¢æ‰€æœ‰å­¦ç”Ÿçš„å­¦ç”Ÿç¼–å·ã€å­¦ç”Ÿå§“åã€é€‰è¯¾æ€»æ•°ã€æ‰€æœ‰è¯¾ç¨‹çš„æ€»æˆç»©(æ²¡æˆç»©çš„æ˜¾ç¤ºä¸º NULL )

```sql
-- å…³è”è¡¨æŸ¥è¯¢
select s.sid,s.sname,count(c1.sid),sum(c1.score) from student s left join sc c1 on s.sid = c1.sid group by sid;
-- ä½¿ç”¨å­æŸ¥è¯¢
-- ä½¿ç”¨å­æŸ¥è¯¢æŸ¥å‡ºæ¯ä¸ªå­¦ç”Ÿçš„é€‰è¯¾æ€»æ•°å’Œæ‰€æœ‰è¯¾ç¨‹çš„æ€»æˆç»©
-- ç„¶åå†å’Œ student è¡¨è¿æ¥
> select sc.sid,count(sc.sid) as allcourse,sum(sc.score) as allscore from sc group by sc.sid;
-- ç¬¬äºŒæ­¥
> select s.sid,s.sname,sub.allcourse,sub.allscore from student s  left join (select sc.sid,count(sc.sid) as allcourse,sum(sc.score) as allscore from sc group by sc.sid) sub on s.sid = sub.sid;
```

6. æŸ¥è¯¢ã€Œæã€å§“è€å¸ˆçš„æ•°é‡

```sql
select count(sname) from student where sname like "æ%";
```

7. æŸ¥è¯¢å­¦è¿‡ã€Œå¼ ä¸‰ã€è€å¸ˆæˆè¯¾çš„åŒå­¦çš„ä¿¡æ¯

```sql
-- æŸ¥è¯¢å¼ ä¸‰è€å¸ˆæˆè¿‡çš„è¯¾
select tid from teacher t where t.tname = "å¼ ä¸‰";
-- ğŸ‘‡ tid = "01";
select cid from course
where
tid = (select tid from teacher t where t.tname = "å¼ ä¸‰");
-- ğŸ‘‡ cid = "02";
-- ğŸ‘‡ sic[];
select sid from sc where
(select cid from course
where
tid = (select tid from teacher t where t.tname = "å¼ ä¸‰"));
-- ğŸ‘‡ student.*;
select * from student where
sid in (select sid from sc where
(select cid from course
where
tid = (select tid from teacher t where t.tname = "å¼ ä¸‰")));
```

8ã€æŸ¥è¯¢æ²¡å­¦è¿‡"å¼ ä¸‰"è€å¸ˆæˆè¯¾çš„åŒå­¦çš„ä¿¡æ¯

```sql
mysql> select * from student stu 
where stu.sid not in(
	select stu.sid from student stu 
	join sc c on stu.sid=c.sid 
	join course co on c.cid=co.cid 
	join teacher t on co.tid = t.tid
);
```

9ã€æŸ¥è¯¢å­¦è¿‡ç¼–å·ä¸º"1"å¹¶ä¸”ä¹Ÿå­¦è¿‡ç¼–å·ä¸º"2"çš„è¯¾ç¨‹çš„åŒå­¦çš„ä¿¡æ¯
```sql
-- æ–¹æ³•ä¸€
select * from student s join sc c on s.sid =c.sid join sc c1 on s.sid = c1.sid where c.cid = "01" and c1.cid ="02";
-- æ–¹æ³•äºŒ
mysql> select stu.* from student stu join (select * from sc where sc.cid = "01") c1 on stu.sid = c1.sid join (select * from sc where sc.cid = "02") c2 on stu.sid = c2.sid;
```
10ã€æŸ¥è¯¢å­¦è¿‡ç¼–å·ä¸º"1"ä½†æ˜¯æ²¡æœ‰å­¦è¿‡ç¼–å·ä¸º"2"çš„è¯¾ç¨‹çš„åŒå­¦çš„ä¿¡æ¯(ä¸å­˜åœ¨æ˜¾ç¤ºnull)
> æ³¨æ„æ­¤å¤„å‡ºè¿‡é”™ï¼šé€‰å–å¾—æ˜¯è¯¾ç¨‹ç¼–å·ä¸º01å¾—å­¦ç”Ÿidï¼Œè€Œä¸æ˜¯æ‰€æœ‰ä¿¡æ¯*
```sql
select * 
from student stu
where stu.sid in 
(select sid from sc where cid = "01") 
and stu.sid not in 
(select sid from sc where cid = "02");

```

```sql

```
